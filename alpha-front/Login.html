<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
        <meta charset="utf-8" />
        <title>Alpha Sing In</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <meta content="" name="description" />
        <meta content="" name="author" />
        <link href="assets/plugins/bootstrapv3/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="assets/plugins/animate.min.css" rel="stylesheet" type="text/css" />
        <link href="assets/plugins/font-awesome/css/font-awesome.css" rel="stylesheet" type="text/css" />
        <link href="common/css/common.css" rel="stylesheet" type="text/css" />
    </head>

    <body >
        <div class="row login-container animated fadeInDown" >
            <div class="modal-content">
                <div class="modal-header">
                   <span class="text-c1">Sign In</span>
                </div>
                <div class="modal-body">
                    <div class="tiles no-margin text-black tab-content">
                        <!-- login -->
                        <div role="tabpanel" class="tab-pane active" id="tab_login">
                            <form class="animated fadeIn " id="form_id" name="">
                                <div class="row form-row xs-m-l-10 xs-m-r-10">
                                    <div class="col-md-8">
                                        <label for="">* Your email</label>
                                        <input class="form-control" name="email" placeholder="zhangsan@qq.com" type="email" required >
                                    </div>
                                    <div class="col-md-8">
                                        <label for="">* Password</label>
                                        <input class="form-control" name="pwd" placeholder="Please enter 6 to 12 Numbers and letters of the password" type="password" required minlength="6" maxlength="12" >
                                    </div>

                                </div>
                                <div role="tablist">
                                    <a id="btn-login" href="" class="btn-cons text-info m-r-30 active m-b-30 " role="tab" data-toggle="tab">
                                        <i class="fa fa-save"></i> Sign up
                                    </a>
                                    <a href="#tab_register" class="btn-cons text-success m-b-30" role="tab" data-toggle="tab"> Sign in</a>
                                </div>
                            </form>
                        </div>
                        <!-- register -->
                        <div role="tabpanel" class="tab-pane" id="tab_register">
                            <form class="animated fadeIn" id="" name="">
                                <div class="row form-row xs-m-l-10 xs-m-r-10">
                                    <div class="col-md-6 col-sm-6">

                                        <label for="">* First name</label>

                                        <input class="form-control" name="firstName" placeholder="Marry" type="text" required>
                                    </div>
                                    <div class="col-md-6 col-sm-6">
                                        <label for="">Last name</label>

                                        <input class="form-control" name="lastName" placeholder="joy" type="text" required>
                                    </div>
                                </div>
                                <div class="row form-row xs-m-l-10 xs-m-r-10">
                                    <div class="col-md-8">

                                        <label for="">* Your email</label>
                                        <input name="email" class="form-control" placeholder="zhangsan@qq.com" type="email" required>
                                    </div>
                                </div>
                                <div class="row form-row xs-m-l-10 xs-m-r-10">
                                    <div class="col-md-8">

                                        <label for="">* Password</label>
                                        <input name="pwd" class="form-control" placeholder="Please enter 6 to 12 Numbers and letters of the password" type="password" required minlength="6" maxlength="12">
                                    </div>
                                </div>
                                <div class="row form-row xs-m-l-10 xs-m-r-10">
                                    <div class="col-md-8">
                                        <label for="">* Password Again</label>
                                        <input name="pwdAgain" class="form-control" placeholder="Please enter 6 to 12 Numbers and letters of the password" type="password" required minlength="6" maxlength="12">
                                    </div>
                                </div>
                                <div class="row form-row xs-m-l-10 xs-m-r-10">
                                    <div class="col-md-8">
                                        <label for="">Invite Code</label>

                                        <input class="form-control" id="login_pass" name="inviteCode" placeholder="2E334G" type="text" required>
                                    </div>
                                </div>
                                <div role="tablist">
                                    <a  id="btn-register" href="" class="btn-cons text-info m-r-30 active m-b-30 " role="tab" data-toggle="tab">
                                        <i class="fa fa-save"></i> Sign In
                                    </a>
                                    <a href="#tab_login" class="btn-cons text-success m-b-30" role="tab" data-toggle="tab"> Sign Up</a>
                                </div>
                            </form>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <script src="assets/plugins/jquery/jquery-1.11.3.min.js" type="text/javascript"></script>
        <script src="assets/plugins/bootstrapv3/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="assets/plugins/jquery-validation/js/jquery.validate.min.js" type="text/javascript"></script>
        <script src="common/js/common.js" type="text/javascript"></script>
        <script type="text/javascript">
        
            $(function () {
                var emailReg=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
                var pwdReg = /^[A-Za-z0-9]{6,12}$/;

                // Login
                $('#btn-login').click(function () {
                    sessionStorage.setItem('alpha_token','');
                    var email = $('#tab_login [name="email"]').val();
                    var pwd = $('#tab_login [name="pwd"]').val();
                    var data = {
                        email : email,
                        password : pwd
                    };
                    if (email && pwd){
                      $.alpha.request_Url('POST','user/login',data,function (res) {
                        if(res.archive.status == 0){
                          sessionStorage.setItem('alpha_token',res.data.token);
                          window.location.href = 'index.html';
                        }else if(res.archive.status == 101){
                            // 弹出框提示用户名或密码错误
                            $.alpha.alertBox('Error','Wrong email or wrong password!','#');
                        }else{
                            // 登录失败提示
                            $.alpha.alertBox('Fail','Login failed!','#');
                        }
                      });
                    }else{
                        // 提示表单验证
                        if(!email){
                            $.alpha.props($('#tab_login [name="email"]').parent(),'right','Not Empty!');
                        }
                        if(!pwd){
                            $.alpha.props($('#tab_login [name="pwd"]').parent(),'right','Not Empty!');
                        }
                    }
                });

                $('[name="email"]').change(function () {
                    if(emailReg.test($(this).val())){
                        $.alpha.props($(this).parent(),'none');
                    }else{
                        $.alpha.props($(this).parent(),'right','Mailbox verification is not legal!');
                    }
                });
                $('[name="pwd"]').change(function () {
                    if(pwdReg.test($(this).val())){
                        $.alpha.props($(this).parent(),'none');
                    }else{
                        $.alpha.props($(this).parent(),'right','Don\'t match the rules!');
                    }
                });
                $('[name="pwdAgain"]').change(function () {
                    if($(this).val() === $('#tab_register [name="pwd"]').val()){
                        $.alpha.props($(this).parent(),'none');
                    }else{
                        $.alpha.props($(this).parent(),'right','Inconsistent password!');
                    }
                });
                $('[name="firstName"]').change(function () {
                    if($(this).val()){
                        $.alpha.props($(this).parent(),'none');
                    }else{
                        $.alpha.props($(this).parent(),'right','Not Empty!');
                    }
                });

                // Register
                $('#btn-register').click(function () {
                    sessionStorage.setItem('alpha_token','');
                    var firstName = $('#tab_register [name="firstName"]').val(),
                      lastName = $('#tab_register [name="lastName"]').val(),
                      email = $('#tab_register [name="email"]').val(),
                      pwd = $('#tab_register [name="pwd"]').val(),
                      inviteCode = $('#tab_register [name="inviteCode"]').val();

                    var data = {
                        first_name : firstName,
                        last_name : lastName,
                        email : email,
                        password : pwd,
                        invite_code : inviteCode
                    };

                    if (firstName && email && pwd){
                        $.alpha.request_Url('POST','user/register',data,function (res) {
                            if(res.archive.status == 0){
                                sessionStorage.setItem('alpha_token',res.data.token);
                                window.location.href = 'index.html';
                            }else if(res.archive.status == 102){
                                // 提示邮箱已存在
                            }else{
                                // 提示注册失败
                                $.alpha.alertBox('Fail','Register failed!','#');
                            }
                        });
                    }else{
                        // 提示表单验证
                        if(!email){
                          $.alpha.props($('#tab_register [name="email"]').parent(),'right','Not Empty!');
                        }
                        if(!pwd){
                          $.alpha.props($('#tab_register [name="pwd"]').parent(),'right','Not Empty!');
                        }
                        if(!firstName){
                          $.alpha.props($('#tab_register [name="firstName"]').parent(),'right','Not Empty!');
                        }
                    }

                });
            });
        </script>
    </body>
</html>
